(self.webpackChunkclaimmyride=self.webpackChunkclaimmyride||[]).push([[3037],{3037:function(t,n,e){"use strict";e.r(n),e.d(n,{ReportsPageModule:function(){return M}});var o=e(1116),r=e(1462),i=e(8809),s=e(578),a=e(4762),p=e(9609),_=e(5803),c=e(9899),g=e(2123),l=e(6282);function d(t,n){if(1&t&&(_.TgZ(0,"ion-select-option",13),_._uU(1),_.qZA()),2&t){var e=n.$implicit;_.Q6J("value",e.id),_.xp6(1),_.Oqu(e.name)}}function u(t,n){if(1&t&&(_.TgZ(0,"ion-select-option",13),_._uU(1),_.qZA()),2&t){var e=n.$implicit;_.Q6J("value",e.id),_.xp6(1),_.Oqu(e.name)}}function m(t,n){if(1&t){var e=_.EpF();_.TgZ(0,"div"),_.TgZ(1,"div",14),_.TgZ(2,"h6"),_._uU(3,"Summary"),_.qZA(),_.TgZ(4,"div",15),_.TgZ(5,"p"),_._uU(6,"Total Trips:"),_.qZA(),_.TgZ(7,"span"),_._uU(8),_.qZA(),_.qZA(),_.TgZ(9,"div",15),_.TgZ(10,"p"),_._uU(11,"Total Distance Traveled:"),_.qZA(),_.TgZ(12,"span"),_._uU(13),_.qZA(),_.qZA(),_.TgZ(14,"div",15),_.TgZ(15,"p"),_._uU(16,"Total Reimbursements:"),_.qZA(),_.TgZ(17,"span"),_._uU(18),_.qZA(),_.qZA(),_.qZA(),_.TgZ(19,"div",16),_.TgZ(20,"p"),_._uU(21,"Export as a PDF (*.PDF) file or an Excel (*.cvs) file"),_.qZA(),_.TgZ(22,"div",17),_.TgZ(23,"ion-button",18),_.NdJ("click",function(){return _.CHM(e),_.oxw().downloadPDF()}),_._UZ(24,"ion-icon",19),_._uU(25," Export PDF"),_.qZA(),_.TgZ(26,"ion-button",18),_.NdJ("click",function(){return _.CHM(e),_.oxw().downloadCSV()}),_._UZ(27,"ion-icon",20),_._uU(28," Export Excel"),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&t){var o=_.oxw();_.xp6(8),_.Oqu(o.summary.total_trips),_.xp6(5),_.AsE("",o.summary.total_distance_traveled,"",o.summary.units,""),_.xp6(5),_.hij("$",o.summary.total_reimbursements,"")}}var h=[{path:"",component:function(){function t(t,n,e,o,r){this.iab=t,this.tripService=n,this.vehicleService=e,this.loadingController=o,this.alertCtrl=r,this.options={},this.summary={},this.vehicles=[],this.tripCategories=[],this.trips=[]}return t.prototype.ionViewDidEnter=function(){this.getVehicles(),this.getTripCategories(),this.getTrips()},t.prototype.ngOnInit=function(){},t.prototype.getTripCategories=function(){var t=this;this.tripService.getTripCategories().then(function(n){t.tripCategories=n})},t.prototype.getVehicles=function(){var t=this;this.vehicleService.getVehicles().then(function(n){t.vehicles=n})},t.prototype.getTrips=function(){var t=this;this.tripService.getTrips().then(function(n){t.trips=n})},t.prototype.getSummary=function(){var t,n;if(this.options.vehicle_id&&this.options.trip_category_id&&this.options.start_date&&this.options.end_date){var e=0,o=0,r=0,i="km";try{for(var s=(0,a.XA)(this.trips),_=s.next();!_.done;_=s.next()){var c=_.value;p(c.start_date).isSameOrAfter(p(this.options.start_date))&&p(c.end_date).isSameOrBefore(p(this.options.end_date))&&this.options.vehicle_id===c.vehicle_id&&(c.trip_categories.indexOf(this.options.trip_category_id)||!this.options.trip_category_id||0===this.options.trip_category_id)&&(e+=1,o+=c.total_distance,r+=c.reimbursement,i=c.units?c.units:i)}}catch(g){t={error:g}}finally{try{_&&!_.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}this.summary.total_trips=e,this.summary.total_distance_traveled=o,this.summary.total_reimbursements=r,this.summary.units=i}},t.prototype.downloadCSV=function(){var t,n=this;this.loadingController.create({message:"Generating CSV file. Please wait...",duration:2e4}).then(function(n){t=n,n.present()});var e={};Object.assign(e,this.options),e.start_date=p(e.start_date).format("YYYY-MM-DD"),e.end_date=p(e.end_date).format("YYYY-MM-DD"),this.tripService.generateCSV(e).then(function(e){n.iab.create(e.url,"_system"),t.dismiss()}).catch(function(){n.alertCtrl.create({header:"Error",message:"There was an error generating your CSV file. Please try again.",buttons:[{text:"Dismiss",role:"cancel",handler:function(t){}}]}).then(function(t){t.present()}),t.dismiss()})},t.prototype.downloadPDF=function(){var t,n=this;this.loadingController.create({message:"Generating PDF. Please wait...",duration:2e4}).then(function(n){t=n,n.present()});var e={};Object.assign(e,this.options),e.start_date=p(e.start_date).format("YYYY-MM-DD"),e.end_date=p(e.end_date).format("YYYY-MM-DD"),this.tripService.generatePDF(e).then(function(e){n.iab.create(e.url,"_system"),t.dismiss()}).catch(function(){n.alertCtrl.create({header:"Error",message:"There was an error generating your PDF file. Please try again.",buttons:[{text:"Dismiss",role:"cancel",handler:function(t){}}]}).then(function(t){t.present()}),t.dismiss()})},t.\u0275fac=function(n){return new(n||t)(_.Y36(c.i),_.Y36(g.a),_.Y36(l.f),_.Y36(i.HT),_.Y36(i.Br))},t.\u0275cmp=_.Xpm({type:t,selectors:[["app-reports"]],decls:30,vars:7,consts:[[1,"reports-header"],["color","light"],["color","primary"],[1,"reports"],[1,"reports__options"],["position","floating"],[3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"reports__options__inline"],["pickerFormat","DD MMMM YYYY","displayFormat","DD MMM YYYY",3,"ngModel","ngModelChange","ionChange"],["name","date","slot","end","color","primary"],["value","0"],[4,"ngIf"],[3,"value"],[1,"reports__summary"],[1,"reports__summary__row"],[1,"reports__export"],[1,"reports__export__buttons"],["color","light","shape","round","expand","full",3,"click"],["name","pdf"],["name","excel"]],template:function(t,n){1&t&&(_.TgZ(0,"ion-header",0),_.TgZ(1,"ion-toolbar",1),_.TgZ(2,"ion-title",2),_._uU(3,"Reports"),_.qZA(),_.qZA(),_.qZA(),_.TgZ(4,"ion-content",3),_.TgZ(5,"div",4),_.TgZ(6,"ion-item"),_.TgZ(7,"ion-label",5),_._uU(8,"Vehicle"),_.qZA(),_.TgZ(9,"ion-select",6),_.NdJ("ngModelChange",function(t){return n.options.vehicle_id=t})("ionChange",function(){return n.getSummary()}),_.YNc(10,d,2,2,"ion-select-option",7),_.qZA(),_.qZA(),_.TgZ(11,"div",8),_.TgZ(12,"ion-item"),_.TgZ(13,"ion-label",5),_._uU(14,"Start Date"),_.qZA(),_.TgZ(15,"ion-datetime",9),_.NdJ("ngModelChange",function(t){return n.options.start_date=t})("ionChange",function(){return n.getSummary()}),_.qZA(),_._UZ(16,"ion-icon",10),_.qZA(),_.TgZ(17,"ion-item"),_.TgZ(18,"ion-label",5),_._uU(19,"End Date"),_.qZA(),_.TgZ(20,"ion-datetime",9),_.NdJ("ngModelChange",function(t){return n.options.end_date=t})("ionChange",function(){return n.getSummary()}),_.qZA(),_._UZ(21,"ion-icon",10),_.qZA(),_.qZA(),_.TgZ(22,"ion-item"),_.TgZ(23,"ion-label",5),_._uU(24,"Trip Category"),_.qZA(),_.TgZ(25,"ion-select",6),_.NdJ("ngModelChange",function(t){return n.options.trip_category_id=t})("ionChange",function(){return n.getSummary()}),_.TgZ(26,"ion-select-option",11),_._uU(27,"All"),_.qZA(),_.YNc(28,u,2,2,"ion-select-option",7),_.qZA(),_.qZA(),_.qZA(),_.YNc(29,m,29,4,"div",12),_.qZA()),2&t&&(_.xp6(9),_.Q6J("ngModel",n.options.vehicle_id),_.xp6(1),_.Q6J("ngForOf",n.vehicles),_.xp6(5),_.Q6J("ngModel",n.options.start_date),_.xp6(5),_.Q6J("ngModel",n.options.end_date),_.xp6(5),_.Q6J("ngModel",n.options.trip_category_id),_.xp6(3),_.Q6J("ngForOf",n.tripCategories),_.xp6(1),_.Q6J("ngIf",n.options.trip_category_id&&n.options.start_date&&n.options.end_date&&n.options.vehicle_id))},directives:[i.Gu,i.sr,i.wd,i.W2,i.Ie,i.Q$,i.t9,i.QI,r.JJ,r.On,o.sg,i.x4,i.gu,i.n0,o.O5,i.YG],styles:[".reports-header[_ngcontent-%COMP%]{background-color:#f6f7eb}.reports[_ngcontent-%COMP%]{--background:#f6f7eb}.reports[_ngcontent-%COMP%]   .reports__options[_ngcontent-%COMP%]{padding-left:15px;padding-right:15px}.reports[_ngcontent-%COMP%]   .reports__options[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--border-width:0px;--border-radius:100px;border-radius:100px;box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f;margin-top:15px;font-weight:700}.reports[_ngcontent-%COMP%]   .reports__options[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]::part(icon){color:#ff7a00!important;opacity:1}.reports[_ngcontent-%COMP%]   .reports__options[_ngcontent-%COMP%]   ion-item.ios[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{transform:translateY(96%);transform-origin:left top;margin:0}.reports[_ngcontent-%COMP%]   .reports__options[_ngcontent-%COMP%]   ion-item.ios.item-has-value[_ngcontent-%COMP%]   .label-floating.sc-ion-label-ios-h[_ngcontent-%COMP%]{transform:translateY(50%) scale(.75)}.reports[_ngcontent-%COMP%]   .reports__options[_ngcontent-%COMP%]   ion-item.ios[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]::part(icon){transform:translate3d(0,-9px,0)}.reports[_ngcontent-%COMP%]   .reports__options[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px;margin:20px 0 0}.reports[_ngcontent-%COMP%]   .reports__options[_ngcontent-%COMP%]   .reports__options__inline[_ngcontent-%COMP%]{display:flex}.reports[_ngcontent-%COMP%]   .reports__options[_ngcontent-%COMP%]   .reports__options__inline[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{flex:1}.reports[_ngcontent-%COMP%]   .reports__options[_ngcontent-%COMP%]   .reports__options__inline[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:first-child{margin-right:5px}.reports[_ngcontent-%COMP%]   .reports__options[_ngcontent-%COMP%]   .reports__options__inline[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:last-child{margin-left:5px}.reports[_ngcontent-%COMP%]   .reports__summary[_ngcontent-%COMP%]{margin-top:20px;padding-left:15px;padding-right:15px}.reports[_ngcontent-%COMP%]   .reports__summary[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:16px;font-weight:500;line-height:20px;color:#23232366;margin-bottom:5px}.reports[_ngcontent-%COMP%]   .reports__summary[_ngcontent-%COMP%]   .reports__summary__row[_ngcontent-%COMP%]{border-bottom:1px solid #2323231f;position:relative;margin:20px 0;padding-bottom:20px}.reports[_ngcontent-%COMP%]   .reports__summary[_ngcontent-%COMP%]   .reports__summary__row[_ngcontent-%COMP%]:last-child{border:none}.reports[_ngcontent-%COMP%]   .reports__summary[_ngcontent-%COMP%]   .reports__summary__row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;top:0;right:0;font-weight:700}.reports[_ngcontent-%COMP%]   .reports__summary[_ngcontent-%COMP%]   .reports__summary__row[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.reports[_ngcontent-%COMP%]   .reports__export[_ngcontent-%COMP%]{background-color:#23232308;text-align:center;padding:30px 15px;margin-top:40px}.reports[_ngcontent-%COMP%]   .reports__export[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;line-height:16px;color:#23232366;letter-spacing:-.2px;margin:0 0 15px}.reports[_ngcontent-%COMP%]   .reports__export[_ngcontent-%COMP%]   .reports__export__buttons[_ngcontent-%COMP%]{display:flex}.reports[_ngcontent-%COMP%]   .reports__export[_ngcontent-%COMP%]   .reports__export__buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{flex:1;--ion-color-contrast:#ff7a00!important;--padding-start:0px;--padding-end:0px}.reports[_ngcontent-%COMP%]   .reports__export[_ngcontent-%COMP%]   .reports__export__buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:first-child{margin-right:5px}.reports[_ngcontent-%COMP%]   .reports__export[_ngcontent-%COMP%]   .reports__export__buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:last-child{margin-left:5px}.reports[_ngcontent-%COMP%]   .reports__export[_ngcontent-%COMP%]   .reports__export__buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:5px}"]}),t}()}],C=function(){function t(){}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=_.oAB({type:t}),t.\u0275inj=_.cJS({imports:[[s.Bz.forChild(h)],s.Bz]}),t}(),M=function(){function t(){}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=_.oAB({type:t}),t.\u0275inj=_.cJS({imports:[[o.ez,r.u5,i.Pc,C]]}),t}()}}]);