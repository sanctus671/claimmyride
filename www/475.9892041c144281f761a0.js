(self.webpackChunkclaimmyride=self.webpackChunkclaimmyride||[]).push([[475],{475:function(e,i,t){"use strict";t.r(i),t.d(i,{AddVehiclePageModule:function(){return T}});var n=t(1116),o=t(1462),r=t(8809),l=t(578),c=t(5803),a=t(2827),h=t(6282),g=t(9899),s=t(303);function u(e,i){1&e&&c._UZ(0,"ion-spinner")}function p(e,i){1&e&&(c.TgZ(0,"p",18),c._uU(1,"Success! Your vehicle was found and the details have been prepopulated below."),c.qZA())}function d(e,i){1&e&&(c.TgZ(0,"p",18),c._uU(1,"Your vehicle was not found. Please enter your vehicle details below."),c.qZA())}function _(e,i){if(1&e){var t=c.EpF();c.TgZ(0,"div"),c.YNc(1,p,2,0,"p",13),c.YNc(2,d,2,0,"p",13),c.TgZ(3,"ion-item"),c.TgZ(4,"ion-label",6),c._uU(5,"Vehicle Make"),c.qZA(),c.TgZ(6,"ion-input",7),c.NdJ("ngModelChange",function(e){return c.CHM(t),c.oxw().vehicle.make=e}),c.qZA(),c.qZA(),c.TgZ(7,"ion-item"),c.TgZ(8,"ion-label",6),c._uU(9,"Vehicle Model"),c.qZA(),c.TgZ(10,"ion-input",7),c.NdJ("ngModelChange",function(e){return c.CHM(t),c.oxw().vehicle.model=e}),c.qZA(),c.qZA(),c.TgZ(11,"ion-item"),c.TgZ(12,"ion-label",6),c._uU(13,"Vehicle Year"),c.qZA(),c.TgZ(14,"ion-input",7),c.NdJ("ngModelChange",function(e){return c.CHM(t),c.oxw().vehicle.year=e}),c.qZA(),c.qZA(),c.TgZ(15,"ion-item"),c.TgZ(16,"ion-label",6),c._uU(17,"Fuel Type"),c.qZA(),c.TgZ(18,"ion-select",14),c.NdJ("ngModelChange",function(e){return c.CHM(t),c.oxw().vehicle.fuel_type=e})("ionChange",function(){return c.CHM(t),c.oxw().updateTaxRates()}),c.TgZ(19,"ion-select-option",15),c._uU(20,"Petrol or diesel"),c.qZA(),c.TgZ(21,"ion-select-option",16),c._uU(22,"Petrol Hybrid"),c.qZA(),c.TgZ(23,"ion-select-option",17),c._uU(24,"Electric"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(25,"ion-item"),c.TgZ(26,"ion-label",6),c._uU(27,"Vehicle Odometer Reading"),c.qZA(),c.TgZ(28,"ion-input",7),c.NdJ("ngModelChange",function(e){return c.CHM(t),c.oxw().vehicle.odometer=e}),c.qZA(),c.qZA(),c.qZA()}if(2&e){var n=c.oxw();c.xp6(1),c.Q6J("ngIf",n.vehicle.found),c.xp6(1),c.Q6J("ngIf",!n.vehicle.found),c.xp6(4),c.Q6J("ngModel",n.vehicle.make),c.xp6(4),c.Q6J("ngModel",n.vehicle.model),c.xp6(4),c.Q6J("ngModel",n.vehicle.year),c.xp6(4),c.Q6J("ngModel",n.vehicle.fuel_type),c.xp6(10),c.Q6J("ngModel",n.vehicle.odometer)}}function v(e,i){if(1&e&&(c.TgZ(0,"ion-select-option",22),c._uU(1),c.qZA()),2&e){var t=i.$implicit;c.Q6J("value",t.id),c.xp6(1),c.Oqu(t.name)}}function f(e,i){if(1&e){var t=c.EpF();c.TgZ(0,"div"),c.TgZ(1,"ion-item"),c.TgZ(2,"ion-label",6),c._uU(3,"Vehicle Type Name"),c.qZA(),c.TgZ(4,"ion-input",7),c.NdJ("ngModelChange",function(e){return c.CHM(t),c.oxw(2).vehicle.vehicle_type_name=e}),c.qZA(),c.qZA(),c.qZA()}if(2&e){var n=c.oxw(2);c.xp6(4),c.Q6J("ngModel",n.vehicle.vehicle_type_name)}}function Z(e,i){if(1&e){var t=c.EpF();c.TgZ(0,"div"),c.TgZ(1,"ion-item"),c.TgZ(2,"ion-label",6),c._uU(3,"Usage Type"),c.qZA(),c.TgZ(4,"ion-select",19),c.NdJ("ngModelChange",function(e){return c.CHM(t),c.oxw().vehicle.vehicle_type_id=e}),c.YNc(5,v,2,2,"ion-select-option",20),c.TgZ(6,"ion-select-option",21),c._uU(7,"Add Vehicle Type"),c.qZA(),c.qZA(),c.qZA(),c.YNc(8,f,5,1,"div",9),c.qZA()}if(2&e){var n=c.oxw();c.xp6(4),c.Q6J("ngModel",n.vehicle.vehicle_type_id),c.xp6(1),c.Q6J("ngForOf",n.vehicleTypes),c.xp6(3),c.Q6J("ngIf","create"===n.vehicle.vehicle_type_id)}}function x(e,i){if(1&e&&(c.TgZ(0,"p",23),c._uU(1),c.qZA()),2&e){var t=c.oxw();c.xp6(1),c.Oqu(t.vehicle.error)}}function m(e,i){1&e&&c._UZ(0,"ion-spinner")}var C=[{path:"",component:function(){function e(e,i,t,n,o,r,l){var c=this;this.driverService=e,this.vehicleService=i,this.navCtrl=t,this.alertCtrl=n,this.activatedRoute=o,this.iab=r,this.authenticationService=l,this.vehicle={km_tax_rate1:.79,km_tax_rate2:.27},this.vehicleService.getVehicleTypes().then(function(e){c.vehicleTypes=e});var a=parseInt(this.activatedRoute.snapshot.params.driverId);this.vehicle.driver_id=a,this.tax={tier_one_petrol:.79,tier_one_hybrid:.79,tier_one_electric:.79,tier_two_petrol:.27,tier_two_hybrid:.16,tier_two_electric:.09},this.user={},this.authenticationService.retreiveUserData().then(function(e){c.user=e,c.user.tax&&(c.tax=JSON.parse(c.user.tax),c.vehicle.km_tax_rate1=c.tax.tier_one_petrol,c.vehicle.km_tax_rate2=c.tax.tier_two_petrol)})}return e.prototype.ngOnInit=function(){},e.prototype.openLink=function(e){this.iab.create(e,"_system")},e.prototype.lookupRegistration=function(){var e=this;this.vehicle.registration&&(this.vehicle.registrationLoading=!0,this.vehicle.registration=this.vehicle.registration.toUpperCase(),this.vehicleService.getVehicleDetails(this.vehicle.registration).then(function(i){var t=(new DOMParser).parseFromString(i,"text/xml"),n=JSON.parse(t.getElementsByTagName("vehicleJson")[0].childNodes[0].nodeValue);e.vehicle.make=n.CarMake?n.CarMake.CurrentTextValue:"",e.vehicle.model=n.CarModel?n.CarModel.CurrentTextValue:"";var o=(n.FuelType?n.FuelType.CurrentTextValue:"").toLowerCase();e.vehicle.fuel_type=o,e.vehicle.year=n.RegistrationYear,e.updateTaxRates(),e.vehicle.lookupCompleted=!0,e.vehicle.found=!0,e.vehicle.registrationLoading=!1}).catch(function(i){e.vehicle.lookupCompleted=!0,e.vehicle.found=!1,e.vehicle.registrationLoading=!1}))},e.prototype.updateTaxRates=function(){"petrol"===this.vehicle.fuel_type?(this.vehicle.km_tax_rate1=this.tax.tier_one_petrol,this.vehicle.km_tax_rate2=this.tax.tier_two_petrol):"hybrid"===this.vehicle.fuel_type?(this.vehicle.km_tax_rate1=this.tax.tier_one_hybrid,this.vehicle.km_tax_rate2=this.tax.tier_two_hybrid):"electric"===this.vehicle.fuel_type&&(this.vehicle.km_tax_rate1=this.tax.tier_one_electric,this.vehicle.km_tax_rate2=this.tax.tier_two_electric)},e.prototype.create=function(){var e=this;this.vehicle.loading=!0,this.vehicle.name=this.vehicle.make+" "+this.vehicle.registration,this.vehicleService.createVehicle(this.vehicle).then(function(){e.vehicle.loading=!1,e.driverService.setDriversUpdated(),e.navCtrl.back()}).catch(function(){e.vehicle.loading=!1,e.alertCtrl.create({header:"Error",message:"There was an error while creating your vehicle. Please try again.",buttons:[{text:"Dismiss",role:"cancel",handler:function(e){}}]}).then(function(e){e.present()})})},e.\u0275fac=function(i){return new(i||e)(c.Y36(a.F),c.Y36(h.f),c.Y36(r.SH),c.Y36(r.Br),c.Y36(l.gz),c.Y36(g.i),c.Y36(s.$))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-add-vehicle"]],decls:22,vars:8,consts:[["color","light"],["slot","start"],["defaultHref","/tabs/track","color","primary"],["color","primary"],[1,"signup"],[1,"signup__form"],["position","floating"],["clearInput","","type","text",3,"ngModel","ngModelChange"],["color","primary","expand","full","shape","round",1,"find-vehicle",3,"disabled","click"],[4,"ngIf"],["class","signup__form__error",4,"ngIf"],[1,"signup-footer"],["color","primary","expand","full","shape","round",1,"signup-footer__button",3,"disabled","click"],["class","vehicle-result",4,"ngIf"],[3,"ngModel","ngModelChange","ionChange"],["value","petrol"],["value","hybrid"],["value","electric"],[1,"vehicle-result"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["value","create"],[3,"value"],[1,"signup__form__error"]],template:function(e,i){1&e&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar",0),c.TgZ(2,"ion-buttons",1),c._UZ(3,"ion-back-button",2),c.qZA(),c.TgZ(4,"ion-title",3),c._uU(5,"Add Vehicle"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(6,"ion-content",4),c.TgZ(7,"ion-list",5),c.TgZ(8,"ion-item"),c.TgZ(9,"ion-label",6),c._uU(10,"Vehicle Registration"),c.qZA(),c.TgZ(11,"ion-input",7),c.NdJ("ngModelChange",function(e){return i.vehicle.registration=e}),c.qZA(),c.qZA(),c.TgZ(12,"ion-button",8),c.NdJ("click",function(){return i.lookupRegistration()}),c._uU(13," Find Vehicle "),c.YNc(14,u,1,0,"ion-spinner",9),c.qZA(),c.YNc(15,_,29,7,"div",9),c.YNc(16,Z,9,3,"div",9),c.YNc(17,x,2,1,"p",10),c.qZA(),c.qZA(),c.TgZ(18,"ion-footer",11),c.TgZ(19,"ion-button",12),c.NdJ("click",function(){return i.create()}),c._uU(20," Add Vehicle "),c.YNc(21,m,1,0,"ion-spinner",9),c.qZA(),c.qZA()),2&e&&(c.xp6(11),c.Q6J("ngModel",i.vehicle.registration),c.xp6(1),c.Q6J("disabled",i.vehicle.registrationLoading||!i.vehicle.registration),c.xp6(2),c.Q6J("ngIf",i.vehicle.registrationLoading),c.xp6(1),c.Q6J("ngIf",i.vehicle.registration&&i.vehicle.lookupCompleted&&!i.vehicle.registrationLoading),c.xp6(1),c.Q6J("ngIf",!1),c.xp6(1),c.Q6J("ngIf",i.vehicle.error),c.xp6(2),c.Q6J("disabled",i.vehicle.loading||!i.vehicle.make||!i.vehicle.registration),c.xp6(2),c.Q6J("ngIf",i.vehicle.loading))},directives:[r.Gu,r.sr,r.Sm,r.oU,r.cs,r.wd,r.W2,r.q_,r.Ie,r.Q$,r.pK,r.j9,o.JJ,o.On,r.YG,n.O5,r.fr,r.PQ,r.t9,r.QI,r.n0,n.sg],styles:[".signup[_ngcontent-%COMP%]   .signup__form[_ngcontent-%COMP%]   .vehicle-result[_ngcontent-%COMP%]{padding:0 15px}.signup[_ngcontent-%COMP%]   .signup__form[_ngcontent-%COMP%]   .find-vehicle[_ngcontent-%COMP%]{margin-top:20px}.signup[_ngcontent-%COMP%]   .signup__form[_ngcontent-%COMP%]   .find-vehicle[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px;margin-left:5px}.signup[_ngcontent-%COMP%]   .signup__form[_ngcontent-%COMP%]   .signup__form__error[_ngcontent-%COMP%]{color:red;font-size:12px;line-height:16px;text-align:Center}.signup[_ngcontent-%COMP%]   .signup__form[_ngcontent-%COMP%]   .signup__form__login[_ngcontent-%COMP%]{margin-top:40px;text-align:Center}.signup[_ngcontent-%COMP%]   .input-sub-text[_ngcontent-%COMP%]{font-size:12px;margin:0 0 10px}.signup-footer[_ngcontent-%COMP%]{background-color:#fff}.signup-footer[_ngcontent-%COMP%]:before{display:none}.signup-footer[_ngcontent-%COMP%]   .signup-footer__button[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px;margin-left:5px}"]}),e}()}],M=function(){function e(){}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[l.Bz.forChild(C)],l.Bz]}),e}(),T=function(){function e(){}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[n.ez,o.u5,r.Pc,M]]}),e}()}}]);